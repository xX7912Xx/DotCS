package components

import (
	"encoding/json"
	"fmt"
	"phoenixbuilder/omega/defines"
)

type Banner struct {
	*defines.BasicComponent
	Cmds [][]string `json:"启动时信息显示" yaml:"启动时信息显示"`
}

func (b *Banner) Init(cfg *defines.ComponentConfig, storage defines.StorageAndLogProvider) {
	m, _ := json.Marshal(cfg.Configs)
	err := json.Unmarshal(m, b)
	if err != nil {
		panic(err)
	}
	for _, cmd := range b.Cmds {
		if len(cmd) != 2 {
			panic(fmt.Errorf("%v should be [target,msg]", cmd))
		}
	}
}

func (b *Banner) Activate() {
	for _, cmd := range b.Cmds {
		b.Frame.GetGameControl().SayTo(cmd[0], cmd[1])
	}
}
